<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////usr/local/MATLAB/R2013a/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for pdist2</title><link rel="stylesheet" href="file:////usr/local/MATLAB/R2013a/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">pdist2 (1 call, 0.018 sec)</span><br/><i>Generated 27-Nov-2014 16:31:19 using cpu time.</i><br/>function in file /usr/local/MATLAB/R2013a/toolbox/stats/stats/pdist2.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file20.html">ExhaustiveSearcher.knnsearch</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line226">226</a></td><td class="td-linebottomrt"><pre>end</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt" class="td-linebottomrt">50.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=50 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line145">145</a></td><td class="td-linebottomrt"><pre>i = find(strncmpi(dist,methods...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt" class="td-linebottomrt">50.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=50 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line346">346</a></td><td class="td-linebottomrt"><pre>end</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt" class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line345">345</a></td><td class="td-linebottomrt"><pre>[D,I] = pdist2mex(X',Y',dist,a...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt" class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line344">344</a></td><td class="td-linebottomrt"><pre>else</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt" class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.018 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file25.html">stats/private/pdist2mex</a></td><td class="td-linebottomrt">MEX-file</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file22.html">parseArgs</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.018 s</td><td class="td-linebottomrt">100.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=100 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.018 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/>No Code Analyzer messages.<div class="grayline"/><strong>Coverage results</strong><br/>Show coverage for parent directory <br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">621</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">200</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">421</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">53</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">368</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">12.59 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF;">function [D,I] = pdist2(X,Y,dist,varargin)</span><br/>               <span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF;">%PDIST2 Pairwise distance between two sets of observations.</span><br/>               <span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF;">%   D = PDIST2(X,Y) returns a matrix D containing the Euclidean distances</span><br/>               <span style="color: #A0A0A0">   4</span> <span style="color: #228B22; background: #FFFFFF;">%   between each pair of observations in the MX-by-N data matrix X and</span><br/>               <span style="color: #A0A0A0">   5</span> <span style="color: #228B22; background: #FFFFFF;">%   MY-by-N data matrix Y. Rows of X and Y correspond to observations,</span><br/>               <span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF;">%   and columns correspond to variables. D is an MX-by-MY matrix, with the</span><br/>               <span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF;">%   (I,J) entry equal to distance between observation I in X and</span><br/>               <span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF;">%   observation J in Y.</span><br/>               <span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF;">%   D = PDIST2(X,Y,DISTANCE) computes D using DISTANCE.  Choices are:</span><br/>               <span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  12</span> <span style="color: #228B22; background: #FFFFFF;">%       'euclidean'   - Euclidean distance (default)</span><br/>               <span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF;">%       'seuclidean'  - Standardized Euclidean distance. Each coordinate</span><br/>               <span style="color: #A0A0A0">  14</span> <span style="color: #228B22; background: #FFFFFF;">%                       difference between rows in X and Y is scaled by</span><br/>               <span style="color: #A0A0A0">  15</span> <span style="color: #228B22; background: #FFFFFF;">%                       dividing by the corresponding element of the</span><br/>               <span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF;">%                       standard deviation computed from X, S=NANSTD(X).</span><br/>               <span style="color: #A0A0A0">  17</span> <span style="color: #228B22; background: #FFFFFF;">%                       To specify another value for S, use</span><br/>               <span style="color: #A0A0A0">  18</span> <span style="color: #228B22; background: #FFFFFF;">%                       D = PDIST2(X,Y,'seuclidean',S).</span><br/>               <span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF;">%       'cityblock'   - City Block distance</span><br/>               <span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF;">%       'minkowski'   - Minkowski distance. The default exponent is 2. To</span><br/>               <span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF;">%                       specify a different exponent, use</span><br/>               <span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF;">%                       D = PDIST2(X,Y,'minkowski',P), where the</span><br/>               <span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF;">%                       exponent P is a scalar positive value.</span><br/>               <span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF;">%       'chebychev'   - Chebychev distance (maximum coordinate difference)</span><br/>               <span style="color: #A0A0A0">  25</span> <span style="color: #228B22; background: #FFFFFF;">%       'mahalanobis' - Mahalanobis distance, using the sample covariance</span><br/>               <span style="color: #A0A0A0">  26</span> <span style="color: #228B22; background: #FFFFFF;">%                       of X as computed by NANCOV.  To compute the</span><br/>               <span style="color: #A0A0A0">  27</span> <span style="color: #228B22; background: #FFFFFF;">%                       distance with a different covariance, use</span><br/>               <span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF;">%                       D = PDIST2(X,Y,'mahalanobis',C), where the matrix C</span><br/>               <span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF;">%                       is symmetric and positive definite.</span><br/>               <span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF;">%       'cosine'      - One minus the cosine of the included angle</span><br/>               <span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF;">%                       between observations (treated as vectors)</span><br/>               <span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;">%       'correlation' - One minus the sample linear correlation between</span><br/>               <span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF;">%                       observations (treated as sequences of values).</span><br/>               <span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF;">%       'spearman'    - One minus the sample Spearman's rank correlation</span><br/>               <span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF;">%                       between observations (treated as sequences of</span><br/>               <span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF;">%                       values)</span><br/>               <span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF;">%       'hamming'     - Hamming distance, percentage of coordinates</span><br/>               <span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF;">%                       that differ</span><br/>               <span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF;">%       'jaccard'     - One minus the Jaccard coefficient, the</span><br/>               <span style="color: #A0A0A0">  40</span> <span style="color: #228B22; background: #FFFFFF;">%                       percentage of nonzero coordinates that differ</span><br/>               <span style="color: #A0A0A0">  41</span> <span style="color: #228B22; background: #FFFFFF;">%       function      - A distance function specified using @, for example</span><br/>               <span style="color: #A0A0A0">  42</span> <span style="color: #228B22; background: #FFFFFF;">%                       @DISTFUN</span><br/>               <span style="color: #A0A0A0">  43</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF;">%   A distance function must be of the form</span><br/>               <span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF;">%         function D2 = DISTFUN(ZI,ZJ),</span><br/>               <span style="color: #A0A0A0">  47</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  48</span> <span style="color: #228B22; background: #FFFFFF;">%   taking as arguments a 1-by-N vector ZI containing a single observation</span><br/>               <span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF;">%   from X or Y, an M2-by-N matrix ZJ containing multiple observations from</span><br/>               <span style="color: #A0A0A0">  50</span> <span style="color: #228B22; background: #FFFFFF;">%   X or Y, and returning an M2-by-1 vector of distances D2, whose Jth</span><br/>               <span style="color: #A0A0A0">  51</span> <span style="color: #228B22; background: #FFFFFF;">%   element is the distance between the observations ZI and ZJ(J,:).</span><br/>               <span style="color: #A0A0A0">  52</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  53</span> <span style="color: #228B22; background: #FFFFFF;">%   For built-in distance metrics, the distance between observation I in X</span><br/>               <span style="color: #A0A0A0">  54</span> <span style="color: #228B22; background: #FFFFFF;">%   and observation J in Y will be NaN if observation I in X or observation</span><br/>               <span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF;">%   J in Y contains NaNs.</span><br/>               <span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  57</span> <span style="color: #228B22; background: #FFFFFF;">%   D = PDIST2(X,Y,DISTANCE,'Smallest',K) returns a K-by-MY matrix D</span><br/>               <span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF;">%   containing the K smallest pairwise distances to observations in X for</span><br/>               <span style="color: #A0A0A0">  59</span> <span style="color: #228B22; background: #FFFFFF;">%   each observation in Y. PDIST2 sorts the distances in each column of D</span><br/>               <span style="color: #A0A0A0">  60</span> <span style="color: #228B22; background: #FFFFFF;">%   in ascending order. D = PDIST2(X,Y,DISTANCE, 'Largest',K) returns the K</span><br/>               <span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF;">%   largest pairwise distances sorted in descending order. If K is greater</span><br/>               <span style="color: #A0A0A0">  62</span> <span style="color: #228B22; background: #FFFFFF;">%   than MX, PDIST2 returns an MX-by-MY distance matrix. For each</span><br/>               <span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF;">%   observation in Y, PDIST2 finds the K smallest or largest distances by</span><br/>               <span style="color: #A0A0A0">  64</span> <span style="color: #228B22; background: #FFFFFF;">%   computing and comparing the distance values to all the observations in</span><br/>               <span style="color: #A0A0A0">  65</span> <span style="color: #228B22; background: #FFFFFF;">%   X.</span><br/>               <span style="color: #A0A0A0">  66</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  67</span> <span style="color: #228B22; background: #FFFFFF;">%   [D,I] = PDIST2(X,Y,DISTANCE,'Smallest',K) returns a K-by-MY matrix I</span><br/>               <span style="color: #A0A0A0">  68</span> <span style="color: #228B22; background: #FFFFFF;">%   containing indices of the observations in X corresponding to the K</span><br/>               <span style="color: #A0A0A0">  69</span> <span style="color: #228B22; background: #FFFFFF;">%   smallest pairwise distances in D. [D,I] = PDIST2(X,Y,DISTANCE,</span><br/>               <span style="color: #A0A0A0">  70</span> <span style="color: #228B22; background: #FFFFFF;">%   'Largest',K) returns indices corresponding to the K largest pairwise</span><br/>               <span style="color: #A0A0A0">  71</span> <span style="color: #228B22; background: #FFFFFF;">%   distances.</span><br/>               <span style="color: #A0A0A0">  72</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  73</span> <span style="color: #228B22; background: #FFFFFF;">%   Example:</span><br/>               <span style="color: #A0A0A0">  74</span> <span style="color: #228B22; background: #FFFFFF;">%      % Compute the ordinary Euclidean distance</span><br/>               <span style="color: #A0A0A0">  75</span> <span style="color: #228B22; background: #FFFFFF;">%      X = randn(100, 5);</span><br/>               <span style="color: #A0A0A0">  76</span> <span style="color: #228B22; background: #FFFFFF;">%      Y = randn(25, 5);</span><br/>               <span style="color: #A0A0A0">  77</span> <span style="color: #228B22; background: #FFFFFF;">%      D = pdist2(X,Y,'euclidean');         % euclidean distance</span><br/>               <span style="color: #A0A0A0">  78</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  79</span> <span style="color: #228B22; background: #FFFFFF;">%      % Compute the Euclidean distance with each coordinate difference</span><br/>               <span style="color: #A0A0A0">  80</span> <span style="color: #228B22; background: #FFFFFF;">%      % scaled by the standard deviation</span><br/>               <span style="color: #A0A0A0">  81</span> <span style="color: #228B22; background: #FFFFFF;">%      Dstd = pdist2(X,Y,'seuclidean');</span><br/>               <span style="color: #A0A0A0">  82</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  83</span> <span style="color: #228B22; background: #FFFFFF;">%      % Use a function handle to compute a distance that weights each</span><br/>               <span style="color: #A0A0A0">  84</span> <span style="color: #228B22; background: #FFFFFF;">%      % coordinate contribution differently.</span><br/>               <span style="color: #A0A0A0">  85</span> <span style="color: #228B22; background: #FFFFFF;">%      Wgts = [.1 .3 .3 .2 .1];            % coordinate weights</span><br/>               <span style="color: #A0A0A0">  86</span> <span style="color: #228B22; background: #FFFFFF;">%      weuc = @(XI,XJ,W)(sqrt(bsxfun(@minus,XI,XJ).^2 * W'));</span><br/>               <span style="color: #A0A0A0">  87</span> <span style="color: #228B22; background: #FFFFFF;">%      Dwgt = pdist2(X,Y, @(Xi,Xj) weuc(Xi,Xj,Wgts));</span><br/>               <span style="color: #A0A0A0">  88</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  89</span> <span style="color: #228B22; background: #FFFFFF;">%   See also PDIST, KNNSEARCH, CREATENS, KDTreeSearcher,</span><br/>               <span style="color: #A0A0A0">  90</span> <span style="color: #228B22; background: #FFFFFF;">%            ExhaustiveSearcher.</span><br/>               <span style="color: #A0A0A0">  91</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  92</span> <span style="color: #228B22; background: #FFFFFF;">%   An example of distance for data with missing elements:</span><br/>               <span style="color: #A0A0A0">  93</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  94</span> <span style="color: #228B22; background: #FFFFFF;">%      X = randn(100, 5);     % some random points</span><br/>               <span style="color: #A0A0A0">  95</span> <span style="color: #228B22; background: #FFFFFF;">%      Y = randn(25, 5);      % some more random points</span><br/>               <span style="color: #A0A0A0">  96</span> <span style="color: #228B22; background: #FFFFFF;">%      X(unidrnd(prod(size(X)),1,20)) = NaN; % scatter in some NaNs</span><br/>               <span style="color: #A0A0A0">  97</span> <span style="color: #228B22; background: #FFFFFF;">%      Y(unidrnd(prod(size(Y)),1,5)) = NaN; % scatter in some NaNs</span><br/>               <span style="color: #A0A0A0">  98</span> <span style="color: #228B22; background: #FFFFFF;">%      D = pdist2(X, Y, @naneucdist);</span><br/>               <span style="color: #A0A0A0">  99</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 100</span> <span style="color: #228B22; background: #FFFFFF;">%      function D = naneucdist(XI, YJ) % euclidean distance, ignoring NaNs</span><br/>               <span style="color: #A0A0A0"> 101</span> <span style="color: #228B22; background: #FFFFFF;">%      [m,p] = size(YJ);</span><br/>               <span style="color: #A0A0A0"> 102</span> <span style="color: #228B22; background: #FFFFFF;">%      sqdxy = bsxfun(@minus,XI,YJ) .^ 2;</span><br/>               <span style="color: #A0A0A0"> 103</span> <span style="color: #228B22; background: #FFFFFF;">%      pstar = sum(~isnan(sqdxy),2); % correction for missing coordinates</span><br/>               <span style="color: #A0A0A0"> 104</span> <span style="color: #228B22; background: #FFFFFF;">%      pstar(pstar == 0) = NaN;</span><br/>               <span style="color: #A0A0A0"> 105</span> <span style="color: #228B22; background: #FFFFFF;">%      D = sqrt(nansum(sqdxy,2) .* p ./ pstar);</span><br/>               <span style="color: #A0A0A0"> 106</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 107</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 108</span> <span style="color: #228B22; background: #FFFFFF;">%   For a large number of observations, it is sometimes faster to compute</span><br/>               <span style="color: #A0A0A0"> 109</span> <span style="color: #228B22; background: #FFFFFF;">%   the distances by looping over coordinates of the data (though the code</span><br/>               <span style="color: #A0A0A0"> 110</span> <span style="color: #228B22; background: #FFFFFF;">%   is more complicated):</span><br/>               <span style="color: #A0A0A0"> 111</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 112</span> <span style="color: #228B22; background: #FFFFFF;">%      function D = nanhamdist(XI, YJ) % hamming distance, ignoring NaNs</span><br/>               <span style="color: #A0A0A0"> 113</span> <span style="color: #228B22; background: #FFFFFF;">%      [m,p] = size(YJ);</span><br/>               <span style="color: #A0A0A0"> 114</span> <span style="color: #228B22; background: #FFFFFF;">%      nesum = zeros(m,1);</span><br/>               <span style="color: #A0A0A0"> 115</span> <span style="color: #228B22; background: #FFFFFF;">%      pstar = zeros(m,1);</span><br/>               <span style="color: #A0A0A0"> 116</span> <span style="color: #228B22; background: #FFFFFF;">%      for q = 1:p</span><br/>               <span style="color: #A0A0A0"> 117</span> <span style="color: #228B22; background: #FFFFFF;">%          notnan = ~(isnan((XI(q)) | isnan(YJ(:,q)));</span><br/>               <span style="color: #A0A0A0"> 118</span> <span style="color: #228B22; background: #FFFFFF;">%          nesum = nesum + (XI(q) ~= YJ(:,q)) &amp; notnan;</span><br/>               <span style="color: #A0A0A0"> 119</span> <span style="color: #228B22; background: #FFFFFF;">%          pstar = pstar + notnan;</span><br/>               <span style="color: #A0A0A0"> 120</span> <span style="color: #228B22; background: #FFFFFF;">%      end</span><br/>               <span style="color: #A0A0A0"> 121</span> <span style="color: #228B22; background: #FFFFFF;">%      D = nesum ./ pstar;</span><br/>               <span style="color: #A0A0A0"> 122</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 123</span> <span style="color: #228B22; background: #FFFFFF;">%   Copyright 2009-2011 The MathWorks, Inc.</span><br/>               <span style="color: #A0A0A0"> 124</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 125</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 126</span> <span style="color: #000000; background: #FFFFFF;">if nargin &lt; 2 </span><br/>               <span style="color: #A0A0A0"> 127</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error(message('stats:pdist2:TooFewInputs'));</span><br/>               <span style="color: #A0A0A0"> 128</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 129</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 130</span> <span style="color: #000000; background: #FFFFFF;">[nx,p] = size(X); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 131</span> <span style="color: #000000; background: #FFFFFF;">[ny,py] = size(Y); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 132</span> <span style="color: #000000; background: #FFFFFF;">if py ~= p </span><br/>               <span style="color: #A0A0A0"> 133</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error(message('stats:pdist2:SizeMismatch'));</span><br/>               <span style="color: #A0A0A0"> 134</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 135</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 136</span> <span style="color: #000000; background: #FFFFFF;">additionalArg = []; </span><br/>               <span style="color: #A0A0A0"> 137</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 138</span> <span style="color: #000000; background: #FFFFFF;">if nargin &lt; 3 </span><br/>               <span style="color: #A0A0A0"> 139</span> <span style="color: #A0A0A0; background: #FFFFFF;">    dist = 'euc';</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 140</span> <span style="color: #228B22; background: #FFFFFF;">else %distance is provided </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 141</span> <span style="color: #000000; background: #FFFFFF;">    if ischar(dist) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 142</span> <span style="color: #000000; background: #FFFFFF;">        methods = {'euclidean'; 'seuclidean'; 'cityblock'; 'chebychev'; ... </span><br/>               <span style="color: #A0A0A0"> 143</span> <span style="color: #000000; background: #FFFFFF;">            'mahalanobis'; 'minkowski'; 'cosine'; 'correlation'; ...</span><br/>               <span style="color: #A0A0A0"> 144</span> <span style="color: #000000; background: #FFFFFF;">            'spearman'; 'hamming'; 'jaccard'};</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 145</span> <a name="Line145"></a><span style="color: #000000; background: #FF8080;">        i = find(strncmpi(dist,methods,length(dist))); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 146</span> <span style="color: #000000; background: #FFFFFF;">        if length(i) &gt; 1 </span><br/>               <span style="color: #A0A0A0"> 147</span> <span style="color: #A0A0A0; background: #FFFFFF;">            error(message('stats:pdist2:AmbiguousDistance', dist));</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 148</span> <span style="color: #000000; background: #FFFFFF;">        elseif isempty(i) </span><br/>               <span style="color: #A0A0A0"> 149</span> <span style="color: #A0A0A0; background: #FFFFFF;">            error(message('stats:pdist2:UnrecognizedDistance', dist));</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 150</span> <span style="color: #228B22; background: #FFFFFF;">        else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 151</span> <span style="color: #000000; background: #FFFFFF;">            dist = methods{i}(1:3); </span><br/>               <span style="color: #A0A0A0"> 152</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 153</span> <span style="color: #000000; background: #FFFFFF;">            if ~isempty(varargin) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 154</span> <span style="color: #000000; background: #FFFFFF;">                arg = varargin{1}; </span><br/>               <span style="color: #A0A0A0"> 155</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>               <span style="color: #A0A0A0"> 156</span> <span style="color: #228B22; background: #FFFFFF;">                % Get the additional distance argument from the inputs</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 157</span> <span style="color: #000000; background: #FFFFFF;">                if isnumeric(arg) </span><br/>               <span style="color: #A0A0A0"> 158</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    switch dist</span><br/>               <span style="color: #A0A0A0"> 159</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        case {'seu' 'mah' 'min'}</span><br/>               <span style="color: #A0A0A0"> 160</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            additionalArg = arg;</span><br/>               <span style="color: #A0A0A0"> 161</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            varargin = varargin(2:end);</span><br/>               <span style="color: #A0A0A0"> 162</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0"> 163</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 164</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 165</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/>               <span style="color: #A0A0A0"> 166</span> <span style="color: #A0A0A0; background: #FFFFFF;">    elseif isa(dist, 'function_handle')</span><br/>               <span style="color: #A0A0A0"> 167</span> <span style="color: #A0A0A0; background: #FFFFFF;">        distfun = dist;</span><br/>               <span style="color: #A0A0A0"> 168</span> <span style="color: #A0A0A0; background: #FFFFFF;">        dist = 'usr';</span><br/>               <span style="color: #A0A0A0"> 169</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 170</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error(message('stats:pdist2:BadDistance'));</span><br/>               <span style="color: #A0A0A0"> 171</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 172</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 173</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 174</span> <span style="color: #000000; background: #FFFFFF;">pnames = {'smallest' 'largest' 'radius'}; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 175</span> <span style="color: #000000; background: #FFFFFF;">dflts =  {        []        []  []}; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 176</span> <span style="color: #000000; background: #FFFFFF;">[smallest,largest,radius] = internal.stats.<a href="file22.html">parseArgs</a>(pnames, dflts, varargin{:}); </span><br/>               <span style="color: #A0A0A0"> 177</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 178</span> <span style="color: #000000; background: #FFFFFF;">smallestLargestFlag = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 179</span> <span style="color: #000000; background: #FFFFFF;">if sum([~isempty(largest) ~isempty(smallest) ~isempty(radius)]) &gt; 1 </span><br/>               <span style="color: #A0A0A0"> 180</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error(message('stats:pdist2:SmallestAndLargest'));</span><br/>               <span style="color: #A0A0A0"> 181</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 182</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(smallest) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 183</span> <span style="color: #000000; background: #FFFFFF;">    if ~(isscalar(smallest) &amp;&amp; isnumeric(smallest) &amp;&amp; smallest &gt;= 1 &amp;&amp; round(smallest) == smallest) </span><br/>               <span style="color: #A0A0A0"> 184</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error(message('stats:pdist2:BadSmallest'));</span><br/>               <span style="color: #A0A0A0"> 185</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 186</span> <span style="color: #000000; background: #FFFFFF;">    smallestLargestFlag = min(smallest,nx); </span><br/>               <span style="color: #A0A0A0"> 187</span> <span style="color: #A0A0A0; background: #FFFFFF;">elseif ~isempty(largest)</span><br/>               <span style="color: #A0A0A0"> 188</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ~(isscalar(largest) &amp;&amp; isnumeric(largest) &amp;&amp; largest &gt;= 1 &amp;&amp; round(largest) == largest)</span><br/>               <span style="color: #A0A0A0"> 189</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error(message('stats:pdist2:BadLargest'));</span><br/>               <span style="color: #A0A0A0"> 190</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 191</span> <span style="color: #A0A0A0; background: #FFFFFF;">    smallestLargestFlag = -min(largest,nx);</span><br/>               <span style="color: #A0A0A0"> 192</span> <span style="color: #A0A0A0; background: #FFFFFF;">elseif ~isempty(radius)</span><br/>               <span style="color: #A0A0A0"> 193</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ~(isscalar(radius) &amp;&amp; isnumeric(radius) &amp;&amp; radius &gt;= 0 )</span><br/>               <span style="color: #A0A0A0"> 194</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error(message('stats:pdist2:BadRadius'));</span><br/>               <span style="color: #A0A0A0"> 195</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 196</span> <span style="color: #A0A0A0; background: #FFFFFF;">elseif nargout &gt; 1</span><br/>               <span style="color: #A0A0A0"> 197</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error(message('stats:pdist2:TooManyOutputs'));</span><br/>               <span style="color: #A0A0A0"> 198</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 199</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 200</span> <span style="color: #228B22; background: #FFFFFF;">% For a built-in distance, integer/logical/char/anything data will be</span><br/>               <span style="color: #A0A0A0"> 201</span> <span style="color: #228B22; background: #FFFFFF;">% converted to float. Complex floating point data can't be handled by</span><br/>               <span style="color: #A0A0A0"> 202</span> <span style="color: #228B22; background: #FFFFFF;">% a built-in distance function.</span><br/>               <span style="color: #A0A0A0"> 203</span> <span style="color: #228B22; background: #FFFFFF;">%if ~strcmp(dist,'usr')</span><br/>               <span style="color: #A0A0A0"> 204</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 205</span> <span style="color: #000000; background: #FFFFFF;">try </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 206</span> <span style="color: #000000; background: #FFFFFF;">    outClass = superiorfloat(X,Y); </span><br/>               <span style="color: #A0A0A0"> 207</span> <span style="color: #A0A0A0; background: #FFFFFF;">catch</span><br/>               <span style="color: #A0A0A0"> 208</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if isfloat(X)</span><br/>               <span style="color: #A0A0A0"> 209</span> <span style="color: #A0A0A0; background: #FFFFFF;">        outClass = class(X);</span><br/>               <span style="color: #A0A0A0"> 210</span> <span style="color: #A0A0A0; background: #FFFFFF;">    elseif isfloat(Y)</span><br/>               <span style="color: #A0A0A0"> 211</span> <span style="color: #A0A0A0; background: #FFFFFF;">        outClass = class(Y);</span><br/>               <span style="color: #A0A0A0"> 212</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 213</span> <span style="color: #A0A0A0; background: #FFFFFF;">        outClass = 'double';</span><br/>               <span style="color: #A0A0A0"> 214</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 215</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 216</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 217</span> <span style="color: #000000; background: #FFFFFF;">if ~strcmp(dist,'usr') </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 218</span> <span style="color: #000000; background: #FFFFFF;">    if ~strcmp(class(X),outClass) || ~strcmp(class(Y),outClass) </span><br/>               <span style="color: #A0A0A0"> 219</span> <span style="color: #A0A0A0; background: #FFFFFF;">        warning(message('stats:pdist2:DataConversion', outClass));</span><br/>               <span style="color: #A0A0A0"> 220</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 221</span> <span style="color: #000000; background: #FFFFFF;">    X = cast(X,outClass); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 222</span> <span style="color: #000000; background: #FFFFFF;">    Y = cast(Y,outClass); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 223</span> <span style="color: #000000; background: #FFFFFF;">    if  ~isreal(X) || ~isreal(Y) </span><br/>               <span style="color: #A0A0A0"> 224</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error(message('stats:pdist2:ComplexData'));</span><br/>               <span style="color: #A0A0A0"> 225</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 226</span> <a name="Line226"></a><span style="color: #000000; background: #FF8080;">end </span><br/>               <span style="color: #A0A0A0"> 227</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 228</span> <span style="color: #228B22; background: #FFFFFF;">% Degenerate case, just return an empty of the proper size.</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 229</span> <span style="color: #000000; background: #FFFFFF;">if (nx == 0) || (ny == 0) </span><br/>               <span style="color: #A0A0A0"> 230</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ~isempty(radius)</span><br/>               <span style="color: #A0A0A0"> 231</span> <span style="color: #A0A0A0; background: #FFFFFF;">        D = repmat({zeros(1,0, outClass)},1,ny);</span><br/>               <span style="color: #A0A0A0"> 232</span> <span style="color: #A0A0A0; background: #FFFFFF;">        I = repmat({zeros(1,0, outClass)},1,ny);</span><br/>               <span style="color: #A0A0A0"> 233</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 234</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ~isempty(smallestLargestFlag)</span><br/>               <span style="color: #A0A0A0"> 235</span> <span style="color: #A0A0A0; background: #FFFFFF;">            nD = abs(smallestLargestFlag);</span><br/>               <span style="color: #A0A0A0"> 236</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 237</span> <span style="color: #A0A0A0; background: #FFFFFF;">            nD = nx;</span><br/>               <span style="color: #A0A0A0"> 238</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 239</span> <span style="color: #A0A0A0; background: #FFFFFF;">        D = zeros(nD,ny,outClass); % X and Y were single/double, or cast to double</span><br/>               <span style="color: #A0A0A0"> 240</span> <span style="color: #A0A0A0; background: #FFFFFF;">        I = zeros(nD,ny,outClass);</span><br/>               <span style="color: #A0A0A0"> 241</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 242</span> <span style="color: #A0A0A0; background: #FFFFFF;">    return;</span><br/>               <span style="color: #A0A0A0"> 243</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 244</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 245</span> <span style="color: #000000; background: #FFFFFF;">switch dist </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 246</span> <span style="color: #000000; background: #FFFFFF;">    case 'seu' % Standardized Euclidean weights by coordinate variance </span><br/>               <span style="color: #A0A0A0"> 247</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isempty(additionalArg)</span><br/>               <span style="color: #A0A0A0"> 248</span> <span style="color: #A0A0A0; background: #FFFFFF;">            additionalArg =  nanvar(X,[],1);</span><br/>               <span style="color: #A0A0A0"> 249</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if any(additionalArg == 0)</span><br/>               <span style="color: #A0A0A0"> 250</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning(message('stats:pdist2:ConstantColumns'));</span><br/>               <span style="color: #A0A0A0"> 251</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 252</span> <span style="color: #A0A0A0; background: #FFFFFF;">            additionalArg = 1./ additionalArg;</span><br/>               <span style="color: #A0A0A0"> 253</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 254</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~(isvector(additionalArg) &amp;&amp; length(additionalArg) == p...</span><br/>               <span style="color: #A0A0A0"> 255</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    &amp;&amp; all(additionalArg &gt;= 0))</span><br/>               <span style="color: #A0A0A0"> 256</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error(message('stats:pdist2:InvalidWeights'));</span><br/>               <span style="color: #A0A0A0"> 257</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 258</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if any(additionalArg == 0)</span><br/>               <span style="color: #A0A0A0"> 259</span> <span style="color: #A0A0A0; background: #FFFFFF;">                warning(message('stats:pdist2:ZeroInverseWeights'));</span><br/>               <span style="color: #A0A0A0"> 260</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 261</span> <span style="color: #A0A0A0; background: #FFFFFF;">            additionalArg = 1./ (additionalArg .^2);</span><br/>               <span style="color: #A0A0A0"> 262</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 263</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 264</span> <span style="color: #000000; background: #FFFFFF;">    case 'mah' % Mahalanobis </span><br/>               <span style="color: #A0A0A0"> 265</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isempty(additionalArg)</span><br/>               <span style="color: #A0A0A0"> 266</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if nx == 1</span><br/>               <span style="color: #A0A0A0"> 267</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error(message('stats:pdist2:tooFewXRowsForMah'));                     </span><br/>               <span style="color: #A0A0A0"> 268</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 269</span> <span style="color: #A0A0A0; background: #FFFFFF;">            additionalArg = nancov(X);</span><br/>               <span style="color: #A0A0A0"> 270</span> <span style="color: #A0A0A0; background: #FFFFFF;">            [T,flag] = chol(additionalArg);</span><br/>               <span style="color: #A0A0A0"> 271</span> <span style="color: #228B22; background: #FFFFFF;">        else %provide the covariance for mahalanobis</span><br/>               <span style="color: #A0A0A0"> 272</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if ~isequal(size(additionalArg),[p,p])</span><br/>               <span style="color: #A0A0A0"> 273</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error(message('stats:pdist2:InvalidCov'));</span><br/>               <span style="color: #A0A0A0"> 274</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 275</span> <span style="color: #228B22; background: #FFFFFF;">            %cholcov will check whether the covariance is symmetric</span><br/>               <span style="color: #A0A0A0"> 276</span> <span style="color: #A0A0A0; background: #FFFFFF;">            [T,flag] = cholcov(additionalArg,0);</span><br/>               <span style="color: #A0A0A0"> 277</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 278</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 279</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if flag ~= 0</span><br/>               <span style="color: #A0A0A0"> 280</span> <span style="color: #A0A0A0; background: #FFFFFF;">            error(message('stats:pdist2:InvalidCov'));</span><br/>               <span style="color: #A0A0A0"> 281</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 282</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 283</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ~issparse(X) &amp;&amp; ~issparse(Y)</span><br/>               <span style="color: #A0A0A0"> 284</span> <span style="color: #A0A0A0; background: #FFFFFF;">            additionalArg = T \ eye(p); %inv(T)</span><br/>               <span style="color: #A0A0A0"> 285</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 286</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 287</span> <span style="color: #000000; background: #FFFFFF;">    case 'min' % Minkowski </span><br/>               <span style="color: #A0A0A0"> 288</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isempty(additionalArg)</span><br/>               <span style="color: #A0A0A0"> 289</span> <span style="color: #A0A0A0; background: #FFFFFF;">            additionalArg = 2;</span><br/>               <span style="color: #A0A0A0"> 290</span> <span style="color: #A0A0A0; background: #FFFFFF;">        elseif ~(isscalar(additionalArg) &amp;&amp; additionalArg &gt; 0)</span><br/>               <span style="color: #A0A0A0"> 291</span> <span style="color: #A0A0A0; background: #FFFFFF;">            error(message('stats:pdist2:BadMinExp'));</span><br/>               <span style="color: #A0A0A0"> 292</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 293</span> <span style="color: #000000; background: #FFFFFF;">    case 'cos' % Cosine </span><br/>               <span style="color: #A0A0A0"> 294</span> <span style="color: #A0A0A0; background: #FFFFFF;">        [X,Y,flag] = normalizeXY(X,Y);</span><br/>               <span style="color: #A0A0A0"> 295</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if flag</span><br/>               <span style="color: #A0A0A0"> 296</span> <span style="color: #A0A0A0; background: #FFFFFF;">            warning(message('stats:pdist2:ZeroPoints'));</span><br/>               <span style="color: #A0A0A0"> 297</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 298</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 299</span> <span style="color: #000000; background: #FFFFFF;">    case 'cor' % Correlation </span><br/>               <span style="color: #A0A0A0"> 300</span> <span style="color: #A0A0A0; background: #FFFFFF;">        X = bsxfun(@minus,X,mean(X,2));</span><br/>               <span style="color: #A0A0A0"> 301</span> <span style="color: #A0A0A0; background: #FFFFFF;">        Y = bsxfun(@minus,Y,mean(Y,2));</span><br/>               <span style="color: #A0A0A0"> 302</span> <span style="color: #A0A0A0; background: #FFFFFF;">        [X,Y,flag] = normalizeXY(X,Y);</span><br/>               <span style="color: #A0A0A0"> 303</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if flag</span><br/>               <span style="color: #A0A0A0"> 304</span> <span style="color: #A0A0A0; background: #FFFFFF;">            warning(message('stats:pdist2:ConstantPoints'));</span><br/>               <span style="color: #A0A0A0"> 305</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 306</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 307</span> <span style="color: #000000; background: #FFFFFF;">    case 'spe' </span><br/>               <span style="color: #A0A0A0"> 308</span> <span style="color: #A0A0A0; background: #FFFFFF;">        X = tiedrank(X')'; % treat rows as a series</span><br/>               <span style="color: #A0A0A0"> 309</span> <span style="color: #A0A0A0; background: #FFFFFF;">        Y = tiedrank(Y')';</span><br/>               <span style="color: #A0A0A0"> 310</span> <span style="color: #A0A0A0; background: #FFFFFF;">        X = X - (p+1)/2; % subtract off the (constant) mean</span><br/>               <span style="color: #A0A0A0"> 311</span> <span style="color: #A0A0A0; background: #FFFFFF;">        Y = Y - (p+1)/2;</span><br/>               <span style="color: #A0A0A0"> 312</span> <span style="color: #A0A0A0; background: #FFFFFF;">        [X,Y,flag] = normalizeXY(X,Y);</span><br/>               <span style="color: #A0A0A0"> 313</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if flag</span><br/>               <span style="color: #A0A0A0"> 314</span> <span style="color: #A0A0A0; background: #FFFFFF;">            warning(message('stats:pdist2:TiedPoints'));</span><br/>               <span style="color: #A0A0A0"> 315</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 316</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 317</span> <span style="color: #000000; background: #FFFFFF;">    otherwise </span><br/>               <span style="color: #A0A0A0"> 318</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 319</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 320</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 321</span> <span style="color: #228B22; background: #FFFFFF;">% Note that if the above switch statement is modified to include the</span><br/>               <span style="color: #A0A0A0"> 322</span> <span style="color: #228B22; background: #FFFFFF;">% 'che', 'euc', or 'cit' distances, that code may need to be repeated</span><br/>               <span style="color: #A0A0A0"> 323</span> <span style="color: #228B22; background: #FFFFFF;">% in the corresponding block below.</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 324</span> <span style="color: #000000; background: #FFFFFF;">if strcmp(dist,'min') % Minkowski distance </span><br/>               <span style="color: #A0A0A0"> 325</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if isinf(additionalArg) %the exponent is inf</span><br/>               <span style="color: #A0A0A0"> 326</span> <span style="color: #A0A0A0; background: #FFFFFF;">        dist = 'che';</span><br/>               <span style="color: #A0A0A0"> 327</span> <span style="color: #A0A0A0; background: #FFFFFF;">        additionalArg = [];</span><br/>               <span style="color: #A0A0A0"> 328</span> <span style="color: #A0A0A0; background: #FFFFFF;">    elseif additionalArg == 2 %the exponent is 2</span><br/>               <span style="color: #A0A0A0"> 329</span> <span style="color: #A0A0A0; background: #FFFFFF;">        dist = 'euc';</span><br/>               <span style="color: #A0A0A0"> 330</span> <span style="color: #A0A0A0; background: #FFFFFF;">        additionalArg = [];</span><br/>               <span style="color: #A0A0A0"> 331</span> <span style="color: #A0A0A0; background: #FFFFFF;">    elseif additionalArg == 1 %the exponent is 1</span><br/>               <span style="color: #A0A0A0"> 332</span> <span style="color: #A0A0A0; background: #FFFFFF;">        dist = 'cit';</span><br/>               <span style="color: #A0A0A0"> 333</span> <span style="color: #A0A0A0; background: #FFFFFF;">        additionalArg = [];</span><br/>               <span style="color: #A0A0A0"> 334</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 335</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 336</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 337</span> <span style="color: #228B22; background: #FFFFFF;">% Call a mex file to compute distances for the build-in distance measures</span><br/>               <span style="color: #A0A0A0"> 338</span> <span style="color: #228B22; background: #FFFFFF;">% on non-sparse real float (double or single) data.</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 339</span> <span style="color: #000000; background: #FFFFFF;">if ~strcmp(dist,'usr') &amp;&amp; (~issparse(X) &amp;&amp; ~issparse(Y)) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 340</span> <span style="color: #000000; background: #FFFFFF;">    additionalArg = cast(additionalArg,outClass); </span><br/>               <span style="color: #A0A0A0"> 341</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 342</span> <span style="color: #000000; background: #FFFFFF;">    if nargout &lt; 2 </span><br/>               <span style="color: #A0A0A0"> 343</span> <span style="color: #A0A0A0; background: #FFFFFF;">        D = pdist2mex(X',Y',dist,additionalArg,smallestLargestFlag,radius);</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 344</span> <a name="Line344"></a><span style="color: #228B22; background: #FFFFFF;">    else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 345</span> <a name="Line345"></a><span style="color: #000000; background: #FFFFFF;">        [D,I] = <a href="file25.html">pdist2mex</a>(X',Y',dist,additionalArg,smallestLargestFlag,radius); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 346</span> <a name="Line346"></a><span style="color: #000000; background: #FFFFFF;">    end </span><br/>               <span style="color: #A0A0A0"> 347</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 348</span> <span style="color: #228B22; background: #FFFFFF;">    % The following MATLAB code implements the same distance calculations as</span><br/>               <span style="color: #A0A0A0"> 349</span> <span style="color: #228B22; background: #FFFFFF;">    % the mex file. It assumes X and Y are real single or double.  It is</span><br/>               <span style="color: #A0A0A0"> 350</span> <span style="color: #228B22; background: #FFFFFF;">    % currently only called for sparse inputs, but it may also be useful as a</span><br/>               <span style="color: #A0A0A0"> 351</span> <span style="color: #228B22; background: #FFFFFF;">    % template for customization.</span><br/>               <span style="color: #A0A0A0"> 352</span> <span style="color: #A0A0A0; background: #FFFFFF;">elseif ~strcmp(dist,'usr')</span><br/>               <span style="color: #A0A0A0"> 353</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if any(strcmp(dist, {'ham' 'jac' 'che'}))</span><br/>               <span style="color: #A0A0A0"> 354</span> <span style="color: #A0A0A0; background: #FFFFFF;">        xnans = any(isnan(X),2);</span><br/>               <span style="color: #A0A0A0"> 355</span> <span style="color: #A0A0A0; background: #FFFFFF;">        ynans = any(isnan(Y),2);</span><br/>               <span style="color: #A0A0A0"> 356</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 357</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 358</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ~isempty(radius)</span><br/>               <span style="color: #A0A0A0"> 359</span> <span style="color: #A0A0A0; background: #FFFFFF;">        D = cell(1,ny);</span><br/>               <span style="color: #A0A0A0"> 360</span> <span style="color: #A0A0A0; background: #FFFFFF;">        I = cell(1,ny);</span><br/>               <span style="color: #A0A0A0"> 361</span> <span style="color: #A0A0A0; background: #FFFFFF;">    elseif isempty(smallestLargestFlag)</span><br/>               <span style="color: #A0A0A0"> 362</span> <span style="color: #A0A0A0; background: #FFFFFF;">        D = zeros(nx,ny,outClass);</span><br/>               <span style="color: #A0A0A0"> 363</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 364</span> <span style="color: #A0A0A0; background: #FFFFFF;">        D = zeros(abs(smallestLargestFlag),ny,outClass);</span><br/>               <span style="color: #A0A0A0"> 365</span> <span style="color: #A0A0A0; background: #FFFFFF;">        I = zeros(abs(smallestLargestFlag),ny,outClass);</span><br/>               <span style="color: #A0A0A0"> 366</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 367</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 368</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 369</span> <span style="color: #A0A0A0; background: #FFFFFF;">    switch dist</span><br/>               <span style="color: #A0A0A0"> 370</span> <span style="color: #A0A0A0; background: #FFFFFF;">        case 'euc'    % Euclidean</span><br/>               <span style="color: #A0A0A0"> 371</span> <span style="color: #A0A0A0; background: #FFFFFF;">            for i = 1:ny</span><br/>               <span style="color: #A0A0A0"> 372</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dsq = zeros(nx,1,outClass);</span><br/>               <span style="color: #A0A0A0"> 373</span> <span style="color: #A0A0A0; background: #FFFFFF;">                for q = 1:p</span><br/>               <span style="color: #A0A0A0"> 374</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    dsq = dsq + (X(:,q) - Y(i,q)).^2;</span><br/>               <span style="color: #A0A0A0"> 375</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 376</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dsq = sqrt(dsq);</span><br/>               <span style="color: #A0A0A0"> 377</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(radius)</span><br/>               <span style="color: #A0A0A0"> 378</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D{i},I{i}] = radiusSort(dsq,radius);</span><br/>               <span style="color: #A0A0A0"> 379</span> <span style="color: #A0A0A0; background: #FFFFFF;">                elseif isempty(smallestLargestFlag)</span><br/>               <span style="color: #A0A0A0"> 380</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    D(:,i) = dsq;</span><br/>               <span style="color: #A0A0A0"> 381</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 382</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D(:,i),I(:,i)] = partialSort(dsq,smallestLargestFlag);</span><br/>               <span style="color: #A0A0A0"> 383</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 384</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 385</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 386</span> <span style="color: #A0A0A0; background: #FFFFFF;">        case 'seu'    % Standardized Euclidean</span><br/>               <span style="color: #A0A0A0"> 387</span> <span style="color: #A0A0A0; background: #FFFFFF;">            wgts = additionalArg;</span><br/>               <span style="color: #A0A0A0"> 388</span> <span style="color: #A0A0A0; background: #FFFFFF;">            for i = 1:ny</span><br/>               <span style="color: #A0A0A0"> 389</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dsq = zeros(nx,1,outClass);</span><br/>               <span style="color: #A0A0A0"> 390</span> <span style="color: #A0A0A0; background: #FFFFFF;">                for q = 1:p</span><br/>               <span style="color: #A0A0A0"> 391</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    dsq = dsq + wgts(q) .* (X(:,q) - Y(i,q)).^2;</span><br/>               <span style="color: #A0A0A0"> 392</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 393</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dsq = sqrt(dsq);</span><br/>               <span style="color: #A0A0A0"> 394</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(radius)</span><br/>               <span style="color: #A0A0A0"> 395</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D{i},I{i}] = radiusSort(dsq,radius);</span><br/>               <span style="color: #A0A0A0"> 396</span> <span style="color: #A0A0A0; background: #FFFFFF;">                elseif isempty(smallestLargestFlag)</span><br/>               <span style="color: #A0A0A0"> 397</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    D(:,i) = dsq;</span><br/>               <span style="color: #A0A0A0"> 398</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 399</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D(:,i),I(:,i)] = partialSort(dsq,smallestLargestFlag);</span><br/>               <span style="color: #A0A0A0"> 400</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 401</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 402</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 403</span> <span style="color: #A0A0A0; background: #FFFFFF;">        case 'cit'    % City Block</span><br/>               <span style="color: #A0A0A0"> 404</span> <span style="color: #A0A0A0; background: #FFFFFF;">            for i = 1:ny</span><br/>               <span style="color: #A0A0A0"> 405</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dsq = zeros(nx,1,outClass);</span><br/>               <span style="color: #A0A0A0"> 406</span> <span style="color: #A0A0A0; background: #FFFFFF;">                for q = 1:p</span><br/>               <span style="color: #A0A0A0"> 407</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    dsq = dsq + abs(X(:,q) - Y(i,q));</span><br/>               <span style="color: #A0A0A0"> 408</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 409</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>               <span style="color: #A0A0A0"> 410</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(radius)</span><br/>               <span style="color: #A0A0A0"> 411</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D{i},I{i}] = radiusSort(dsq,radius);</span><br/>               <span style="color: #A0A0A0"> 412</span> <span style="color: #A0A0A0; background: #FFFFFF;">                elseif isempty(smallestLargestFlag)</span><br/>               <span style="color: #A0A0A0"> 413</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    D(:,i) = dsq;</span><br/>               <span style="color: #A0A0A0"> 414</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 415</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D(:,i),I(:,i)] = partialSort(dsq,smallestLargestFlag);</span><br/>               <span style="color: #A0A0A0"> 416</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 417</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 418</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 419</span> <span style="color: #A0A0A0; background: #FFFFFF;">        case 'mah'    % Mahalanobis</span><br/>               <span style="color: #A0A0A0"> 420</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 421</span> <span style="color: #A0A0A0; background: #FFFFFF;">            for i = 1:ny</span><br/>               <span style="color: #A0A0A0"> 422</span> <span style="color: #A0A0A0; background: #FFFFFF;">                del = bsxfun(@minus,X,Y(i,:));</span><br/>               <span style="color: #A0A0A0"> 423</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dsq = sum((del/T) .^ 2, 2);</span><br/>               <span style="color: #A0A0A0"> 424</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dsq = sqrt(dsq);</span><br/>               <span style="color: #A0A0A0"> 425</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(radius)</span><br/>               <span style="color: #A0A0A0"> 426</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D{i},I{i}] = radiusSort(dsq,radius);</span><br/>               <span style="color: #A0A0A0"> 427</span> <span style="color: #A0A0A0; background: #FFFFFF;">                elseif isempty(smallestLargestFlag)</span><br/>               <span style="color: #A0A0A0"> 428</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    D(:,i) = dsq;</span><br/>               <span style="color: #A0A0A0"> 429</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 430</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D(:,i),I(:,i)] = partialSort(dsq,smallestLargestFlag);</span><br/>               <span style="color: #A0A0A0"> 431</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 432</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 433</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 434</span> <span style="color: #A0A0A0; background: #FFFFFF;">        case 'min'    % Minkowski</span><br/>               <span style="color: #A0A0A0"> 435</span> <span style="color: #A0A0A0; background: #FFFFFF;">            expon = additionalArg;</span><br/>               <span style="color: #A0A0A0"> 436</span> <span style="color: #A0A0A0; background: #FFFFFF;">            for i = 1:ny</span><br/>               <span style="color: #A0A0A0"> 437</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dpow = zeros(nx,1,outClass);</span><br/>               <span style="color: #A0A0A0"> 438</span> <span style="color: #A0A0A0; background: #FFFFFF;">                for q = 1:p</span><br/>               <span style="color: #A0A0A0"> 439</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    dpow = dpow + abs(X(:,q) - Y(i,q)).^expon;</span><br/>               <span style="color: #A0A0A0"> 440</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 441</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dpow = dpow .^ (1./expon);</span><br/>               <span style="color: #A0A0A0"> 442</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(radius)</span><br/>               <span style="color: #A0A0A0"> 443</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D{i},I{i}] = radiusSort(dpow,radius);</span><br/>               <span style="color: #A0A0A0"> 444</span> <span style="color: #A0A0A0; background: #FFFFFF;">                elseif isempty(smallestLargestFlag)</span><br/>               <span style="color: #A0A0A0"> 445</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    D(:,i) = dpow;</span><br/>               <span style="color: #A0A0A0"> 446</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 447</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D(:,i),I(:,i)] = partialSort(dpow,smallestLargestFlag);</span><br/>               <span style="color: #A0A0A0"> 448</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 449</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>               <span style="color: #A0A0A0"> 450</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 451</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 452</span> <span style="color: #A0A0A0; background: #FFFFFF;">        case {'cos' 'cor' 'spe'}   % Cosine, Correlation, Rank Correlation</span><br/>               <span style="color: #A0A0A0"> 453</span> <span style="color: #228B22; background: #FFFFFF;">            % This assumes that data have been appropriately preprocessed</span><br/>               <span style="color: #A0A0A0"> 454</span> <span style="color: #A0A0A0; background: #FFFFFF;">            for i = 1:ny</span><br/>               <span style="color: #A0A0A0"> 455</span> <span style="color: #A0A0A0; background: #FFFFFF;">                d = zeros(nx,1,outClass);</span><br/>               <span style="color: #A0A0A0"> 456</span> <span style="color: #A0A0A0; background: #FFFFFF;">                for q = 1:p</span><br/>               <span style="color: #A0A0A0"> 457</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    d = d + (X(:,q).*Y(i,q));</span><br/>               <span style="color: #A0A0A0"> 458</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 459</span> <span style="color: #A0A0A0; background: #FFFFFF;">                d(d&gt;1) = 1; % protect against round-off, don't overwrite NaNs</span><br/>               <span style="color: #A0A0A0"> 460</span> <span style="color: #A0A0A0; background: #FFFFFF;">                d = 1 - d;</span><br/>               <span style="color: #A0A0A0"> 461</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(radius)</span><br/>               <span style="color: #A0A0A0"> 462</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D{i},I{i}] = radiusSort(d,radius);</span><br/>               <span style="color: #A0A0A0"> 463</span> <span style="color: #A0A0A0; background: #FFFFFF;">                elseif isempty(smallestLargestFlag)</span><br/>               <span style="color: #A0A0A0"> 464</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    D(:,i) = d;</span><br/>               <span style="color: #A0A0A0"> 465</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 466</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D(:,i),I(:,i)] = partialSort(d,smallestLargestFlag);</span><br/>               <span style="color: #A0A0A0"> 467</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 468</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>               <span style="color: #A0A0A0"> 469</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 470</span> <span style="color: #A0A0A0; background: #FFFFFF;">        case 'ham'    % Hamming</span><br/>               <span style="color: #A0A0A0"> 471</span> <span style="color: #A0A0A0; background: #FFFFFF;">            for i = 1:ny</span><br/>               <span style="color: #A0A0A0"> 472</span> <span style="color: #A0A0A0; background: #FFFFFF;">                nesum = zeros(nx,1,outClass);</span><br/>               <span style="color: #A0A0A0"> 473</span> <span style="color: #A0A0A0; background: #FFFFFF;">                for q = 1:p</span><br/>               <span style="color: #A0A0A0"> 474</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    nesum = nesum + (X(:,q) ~= Y(i,q));</span><br/>               <span style="color: #A0A0A0"> 475</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 476</span> <span style="color: #A0A0A0; background: #FFFFFF;">                nesum(xnans|ynans(i)) = NaN;</span><br/>               <span style="color: #A0A0A0"> 477</span> <span style="color: #A0A0A0; background: #FFFFFF;">                nesum = (nesum ./ p);</span><br/>               <span style="color: #A0A0A0"> 478</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(radius)</span><br/>               <span style="color: #A0A0A0"> 479</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D{i},I{i}] = radiusSort(nesum,radius);</span><br/>               <span style="color: #A0A0A0"> 480</span> <span style="color: #A0A0A0; background: #FFFFFF;">                elseif isempty(smallestLargestFlag)</span><br/>               <span style="color: #A0A0A0"> 481</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    D(:,i) = nesum;</span><br/>               <span style="color: #A0A0A0"> 482</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 483</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D(:,i),I(:,i)] = partialSort(nesum,smallestLargestFlag);</span><br/>               <span style="color: #A0A0A0"> 484</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 485</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>               <span style="color: #A0A0A0"> 486</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 487</span> <span style="color: #A0A0A0; background: #FFFFFF;">        case 'jac'    % Jaccard</span><br/>               <span style="color: #A0A0A0"> 488</span> <span style="color: #A0A0A0; background: #FFFFFF;">            for i = 1:ny</span><br/>               <span style="color: #A0A0A0"> 489</span> <span style="color: #A0A0A0; background: #FFFFFF;">                nzsum = zeros(nx,1,outClass);</span><br/>               <span style="color: #A0A0A0"> 490</span> <span style="color: #A0A0A0; background: #FFFFFF;">                nesum = zeros(nx,1,outClass);</span><br/>               <span style="color: #A0A0A0"> 491</span> <span style="color: #A0A0A0; background: #FFFFFF;">                for q = 1:p</span><br/>               <span style="color: #A0A0A0"> 492</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    nz = (X(:,q) ~= 0 | Y(i,q) ~= 0);</span><br/>               <span style="color: #A0A0A0"> 493</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ne = (X(:,q) ~= Y(i,q));</span><br/>               <span style="color: #A0A0A0"> 494</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    nzsum = nzsum + nz;</span><br/>               <span style="color: #A0A0A0"> 495</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    nesum = nesum + (nz &amp; ne);</span><br/>               <span style="color: #A0A0A0"> 496</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 497</span> <span style="color: #A0A0A0; background: #FFFFFF;">                nesum(xnans | ynans(i)) = NaN;</span><br/>               <span style="color: #A0A0A0"> 498</span> <span style="color: #A0A0A0; background: #FFFFFF;">                d = (nesum ./ nzsum);</span><br/>               <span style="color: #A0A0A0"> 499</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(radius)</span><br/>               <span style="color: #A0A0A0"> 500</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D{i},I{i}] = radiusSort(d,radius);</span><br/>               <span style="color: #A0A0A0"> 501</span> <span style="color: #A0A0A0; background: #FFFFFF;">                elseif isempty(smallestLargestFlag)</span><br/>               <span style="color: #A0A0A0"> 502</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    D(:,i) = d;</span><br/>               <span style="color: #A0A0A0"> 503</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 504</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D(:,i),I(:,i)] = partialSort(d,smallestLargestFlag);</span><br/>               <span style="color: #A0A0A0"> 505</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 506</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>               <span style="color: #A0A0A0"> 507</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 508</span> <span style="color: #A0A0A0; background: #FFFFFF;">        case 'che'    % Chebychev</span><br/>               <span style="color: #A0A0A0"> 509</span> <span style="color: #A0A0A0; background: #FFFFFF;">            for i = 1:ny</span><br/>               <span style="color: #A0A0A0"> 510</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dmax = zeros(nx,1,outClass);</span><br/>               <span style="color: #A0A0A0"> 511</span> <span style="color: #A0A0A0; background: #FFFFFF;">                for q = 1:p</span><br/>               <span style="color: #A0A0A0"> 512</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    dmax = max(dmax, abs(X(:,q) - Y(i,q)));</span><br/>               <span style="color: #A0A0A0"> 513</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 514</span> <span style="color: #A0A0A0; background: #FFFFFF;">                dmax(xnans | ynans(i)) = NaN;</span><br/>               <span style="color: #A0A0A0"> 515</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if ~isempty(radius)</span><br/>               <span style="color: #A0A0A0"> 516</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D{i},I{i}] = radiusSort(dmax,radius);</span><br/>               <span style="color: #A0A0A0"> 517</span> <span style="color: #A0A0A0; background: #FFFFFF;">                elseif isempty(smallestLargestFlag)</span><br/>               <span style="color: #A0A0A0"> 518</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    D(:,i) =  dmax;</span><br/>               <span style="color: #A0A0A0"> 519</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 520</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    [D(:,i),I(:,i)] = partialSort(dmax,smallestLargestFlag);</span><br/>               <span style="color: #A0A0A0"> 521</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 522</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 523</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 524</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 525</span> <span style="color: #228B22; background: #FFFFFF;">    % Compute distances for a caller-defined distance function.</span><br/>               <span style="color: #A0A0A0"> 526</span> <span style="color: #228B22; background: #FFFFFF;">else % if strcmp(dist,'usr')</span><br/>               <span style="color: #A0A0A0"> 527</span> <span style="color: #A0A0A0; background: #FFFFFF;">    try</span><br/>               <span style="color: #A0A0A0"> 528</span> <span style="color: #A0A0A0; background: #FFFFFF;">        D = feval(distfun,Y(1,:),X(1,:));</span><br/>               <span style="color: #A0A0A0"> 529</span> <span style="color: #A0A0A0; background: #FFFFFF;">    catch ME</span><br/>               <span style="color: #A0A0A0"> 530</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if strcmp('MATLAB:UndefinedFunction', ME.identifier) ...</span><br/>               <span style="color: #A0A0A0"> 531</span> <span style="color: #A0A0A0; background: #FFFFFF;">                &amp;&amp; ~isempty(strfind(ME.message, func2str(distfun)))</span><br/>               <span style="color: #A0A0A0"> 532</span> <span style="color: #A0A0A0; background: #FFFFFF;">            error(message('stats:pdist2:DistanceFunctionNotFound', func2str( distfun )));</span><br/>               <span style="color: #A0A0A0"> 533</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 534</span> <span style="color: #228B22; background: #FFFFFF;">        % Otherwise, let the catch block below generate the error message</span><br/>               <span style="color: #A0A0A0"> 535</span> <span style="color: #A0A0A0; background: #FFFFFF;">        D = [];</span><br/>               <span style="color: #A0A0A0"> 536</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 537</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 538</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ~isnumeric(D)</span><br/>               <span style="color: #A0A0A0"> 539</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error(message('stats:pdist2:OutputBadType'));</span><br/>               <span style="color: #A0A0A0"> 540</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 541</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 542</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ~isempty(radius)</span><br/>               <span style="color: #A0A0A0"> 543</span> <span style="color: #A0A0A0; background: #FFFFFF;">        D = cell(1,ny);</span><br/>               <span style="color: #A0A0A0"> 544</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if nargout &gt;= 2</span><br/>               <span style="color: #A0A0A0"> 545</span> <span style="color: #A0A0A0; background: #FFFFFF;">            I = cell(1,ny);</span><br/>               <span style="color: #A0A0A0"> 546</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 547</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 548</span> <span style="color: #A0A0A0; background: #FFFFFF;">        for i = 1:ny</span><br/>               <span style="color: #A0A0A0"> 549</span> <span style="color: #A0A0A0; background: #FFFFFF;">            try</span><br/>               <span style="color: #A0A0A0"> 550</span> <span style="color: #A0A0A0; background: #FFFFFF;">                temp = feval(distfun,Y(i,:),X);</span><br/>               <span style="color: #A0A0A0"> 551</span> <span style="color: #A0A0A0; background: #FFFFFF;">            catch ME</span><br/>               <span style="color: #A0A0A0"> 552</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if isa(distfun, 'inline')</span><br/>               <span style="color: #A0A0A0"> 553</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    m = message('stats:pdist2:DistanceInlineError');</span><br/>               <span style="color: #A0A0A0"> 554</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ME2 = MException(m.Identifier,'%s',getString(m));</span><br/>               <span style="color: #A0A0A0"> 555</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    throw(addCause(ME2,ME));</span><br/>               <span style="color: #A0A0A0"> 556</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 557</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    m = message('stats:pdist2:DistanceFunctionError',func2str(distfun));</span><br/>               <span style="color: #A0A0A0"> 558</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ME2 = MException(m.Identifier,'%s',getString(m));</span><br/>               <span style="color: #A0A0A0"> 559</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    throw(addCause(ME2,ME));</span><br/>               <span style="color: #A0A0A0"> 560</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 561</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 562</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 563</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if nargout &lt; 2</span><br/>               <span style="color: #A0A0A0"> 564</span> <span style="color: #A0A0A0; background: #FFFFFF;">                D{i} = radiusSort(temp,radius);</span><br/>               <span style="color: #A0A0A0"> 565</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0"> 566</span> <span style="color: #A0A0A0; background: #FFFFFF;">                [D{i},I{i}] = radiusSort(temp, radius);</span><br/>               <span style="color: #A0A0A0"> 567</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 568</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 569</span> <span style="color: #A0A0A0; background: #FFFFFF;">    elseif ~isempty(smallestLargestFlag)</span><br/>               <span style="color: #A0A0A0"> 570</span> <span style="color: #A0A0A0; background: #FFFFFF;">        D = zeros(abs(smallestLargestFlag),ny,class(D));</span><br/>               <span style="color: #A0A0A0"> 571</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if nargout &gt; 1</span><br/>               <span style="color: #A0A0A0"> 572</span> <span style="color: #A0A0A0; background: #FFFFFF;">            I = zeros(abs(smallestLargestFlag),ny,class(D));</span><br/>               <span style="color: #A0A0A0"> 573</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 574</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 575</span> <span style="color: #A0A0A0; background: #FFFFFF;">        for i = 1:ny</span><br/>               <span style="color: #A0A0A0"> 576</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 577</span> <span style="color: #A0A0A0; background: #FFFFFF;">            try</span><br/>               <span style="color: #A0A0A0"> 578</span> <span style="color: #A0A0A0; background: #FFFFFF;">                temp = feval(distfun,Y(i,:),X);</span><br/>               <span style="color: #A0A0A0"> 579</span> <span style="color: #A0A0A0; background: #FFFFFF;">            catch ME</span><br/>               <span style="color: #A0A0A0"> 580</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if isa(distfun, 'inline')</span><br/>               <span style="color: #A0A0A0"> 581</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    m = message('stats:pdist2:DistanceInlineError');</span><br/>               <span style="color: #A0A0A0"> 582</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ME2 = MException(m.Identifier,'%s',getString(m));</span><br/>               <span style="color: #A0A0A0"> 583</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    throw(addCause(ME2,ME));</span><br/>               <span style="color: #A0A0A0"> 584</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 585</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    m = message('stats:pdist2:DistanceFunctionError',func2str(distfun));</span><br/>               <span style="color: #A0A0A0"> 586</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ME2 = MException(m.Identifier,'%s',getString(m));</span><br/>               <span style="color: #A0A0A0"> 587</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    throw(addCause(ME2,ME));</span><br/>               <span style="color: #A0A0A0"> 588</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 589</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 590</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 591</span> <span style="color: #A0A0A0; background: #FFFFFF;">            if nargout &lt; 2</span><br/>               <span style="color: #A0A0A0"> 592</span> <span style="color: #A0A0A0; background: #FFFFFF;">                D(:,i) = partialSort(temp,smallestLargestFlag);</span><br/>               <span style="color: #A0A0A0"> 593</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0"> 594</span> <span style="color: #A0A0A0; background: #FFFFFF;">                [D(:,i),I(:,i)] = partialSort(temp,smallestLargestFlag);</span><br/>               <span style="color: #A0A0A0"> 595</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 596</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 597</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 598</span> <span style="color: #228B22; background: #FFFFFF;">    else  %compute all the pairwise distance</span><br/>               <span style="color: #A0A0A0"> 599</span> <span style="color: #228B22; background: #FFFFFF;">        % Make the return have whichever numeric type the distance function</span><br/>               <span style="color: #A0A0A0"> 600</span> <span style="color: #228B22; background: #FFFFFF;">        % returns.</span><br/>               <span style="color: #A0A0A0"> 601</span> <span style="color: #A0A0A0; background: #FFFFFF;">        D = zeros(nx,ny,class(D));</span><br/>               <span style="color: #A0A0A0"> 602</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 603</span> <span style="color: #A0A0A0; background: #FFFFFF;">        for i = 1:ny</span><br/>               <span style="color: #A0A0A0"> 604</span> <span style="color: #A0A0A0; background: #FFFFFF;">            try</span><br/>               <span style="color: #A0A0A0"> 605</span> <span style="color: #A0A0A0; background: #FFFFFF;">                D(:,i) = feval(distfun,Y(i,:),X);</span><br/>               <span style="color: #A0A0A0"> 606</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>               <span style="color: #A0A0A0"> 607</span> <span style="color: #A0A0A0; background: #FFFFFF;">            catch ME</span><br/>               <span style="color: #A0A0A0"> 608</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if isa(distfun, 'inline')</span><br/>               <span style="color: #A0A0A0"> 609</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    m = message('stats:pdist2:DistanceInlineError');</span><br/>               <span style="color: #A0A0A0"> 610</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ME2 = MException(m.Identifier,'%s',getString(m));</span><br/>               <span style="color: #A0A0A0"> 611</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    throw(addCause(ME2,ME));</span><br/>               <span style="color: #A0A0A0"> 612</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 613</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    m = message('stats:pdist2:DistanceFunctionError',func2str(distfun));</span><br/>               <span style="color: #A0A0A0"> 614</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    ME2 = MException(m.Identifier,'%s',getString(m));</span><br/>               <span style="color: #A0A0A0"> 615</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    throw(addCause(ME2,ME));</span><br/>               <span style="color: #A0A0A0"> 616</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 617</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 618</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 619</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 620</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 621</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>